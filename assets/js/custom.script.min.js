function getMovie(keyword,page = '1') {
	let siteApi = 'https://www.omdbapi.com/';
	let key = '744e7064';
	$.ajax({
		url : siteApi,
		method : 'get',
		data : {
			'apikey' : key,
			's' : keyword,
			'page' : page
		},
		success : function(result) {
			$('.introduction').slideUp('1s');
			$('.content-result').html(``);
			if (! result.Error) {
				result.Search.forEach(function(item){
					$('.content-result').append(`
						<div class="col-md-4 pt-3 mb-3">
							<div class="card" style="border:none;box-shadow:5px 15px 15px 1px rgba(150,150,150,0.2)">
								<img class="card-img-top d-inline-block m-auto" style="border-radius:5px;background:#214254" src="${item.Poster}" onError="this.src='/info-movie/assets/img/error.png'" alt="">
								<div class="card-body">
								  <h5 class="card-title" style="color:#214254">${item.Title}</h5>
								  <h6 class="card-subtitle mb-3 text-muted">Year : ${item.Year}</h6>
								  <h6 class="card-subtitle mb-3 text-muted">Type : ${item.Type}</h6>
						      <button data-id="${item.imdbID}" class="btn btn-primary btn-detail-movie" data-toggle="modal" data-target="#detail-movie">Detail</button>
							  </div>
							</div>						
						</div>
					`);
				});
				$('.page').css({
					'visibility' : 'visible'
				});
				if (page > 1) {
					$('.page .prev').fadeIn('1s');
					$('.page .number').fadeIn('1s');
					$('.page .number').text(page);
				} else {
					$('.page .number').fadeOut('1s');
					$('.page .number').text(page);
					$('.page .prev').fadeOut('1s');
				}
			} else {
				$('.content-result').html(`
					<h1 class="m-auto pt-3" style="color:#214254">${result.Error}</h1>
				`);
				$('.page .prev').fadeIn('1s');
				$('.page .next').fadeOut('1s');
			}
			$('.btn-detail-movie').on('click',function(){
				$('.detail-content').html(`
					<span class="d-block text-center" style="color:#214254">• • • Memuat • • •</span>
				`);
				$.ajax({
					url : siteApi,
					method : 'get',
					data : {
						'apikey' : key,
						'i' : $(this).data('id')
					},
					success : function(detail) {
						$('.detail-content').html(`
							<ul class="list-group">
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Title</span> : ${detail.Title}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Year</span> : ${detail.Year}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Rated</span> : ${detail.Rated}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Released</span> : ${detail.Released}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Runtime</span> : ${detail.Runtime}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Genre</span> : ${detail.Genre}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Director</span> : ${detail.Director}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Writer</span> : ${detail.Writer}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Actors</span> : ${detail.Actors}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Plot</span> : ${detail.Plot}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Language</span> : ${detail.Language}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Country</span> : ${detail.Country}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Awards</span> : ${detail.Awards}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Rating</span> : ${detail.Ratings[0].Source} (${detail.Ratings[0].Value})</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Imdb Ratings</span> : ${detail.imdbRating}</li>
							  <li class="list-group-item" style="color:#214254"><span class="text-primary">Imdb Votes</span> : ${detail.imdbVotes}</li>
							</ul>
						`)
					}
				});
			});
		},
		error : function(e) {
			if (e.responseJSON.Error) {
				$('.introduction').slideUp('1s');
				$('.content-result').html(`
					<h1 class="text-center pt-3" style="color:#214254">Maaf kuota pencarian telah habis silahkan coba lagi besok</h1>
				`);
			}
		}
	});
}
$('.search-movie button').on('click',function(){
	if ($('.search-movie input').val().indexOf(' ') == 0 || $('.search-movie input').val() == '') {
		$('.search-movie button').attr('class','btn btn-outline-danger ml-1');
	} else {
		$('.search-movie button').attr('class','btn btn-outline-dark ml-1');
		getMovie($('.search-movie input').val());
	}
});
$('.search-movie input').on('keyup',function(event){
	if (event.keyCode == 13) {
		if ($('.search-movie input').val().indexOf(' ') == 0 || $('.search-movie input').val() == '') {
			$('.search-movie button').attr('class','btn btn-outline-danger ml-1');
		} else {
			$('.search-movie button').attr('class','btn btn-outline-dark ml-1');
			getMovie($('.search-movie input').val());
		}
	}
});
var i = 1;
$('.page .next').on('click',function(){
	if ($('.search-movie input').val().indexOf(' ') == 0 || $('.search-movie input').val() == '') {
		$('.page').css({
			'visibility' : 'hidden'
		});
	} else {
		i++;
		getMovie($('.search-movie input').val(),i);
	}
});
$('.page .prev').on('click',function(){
	if ($('.search-movie input').val().indexOf(' ') == 0 || $('.search-movie input').val() == '') {
		$('.page').css({
			'visibility' : 'hidden'
		});
	} else {
		i--;
		if (i <= 0) {
			i = 1;
		} else {
			getMovie($('.search-movie input').val(),i);
		}
	}
});
function loadPage(name) {
	$.ajax({
		url : document.location.origin.concat(`/info-movie/${name}.html`),
		method : 'get',
		success : function(content) {
			$('.introduction').fadeOut('1s');
			setTimeout(function(){
				$('.content-result').html(content);
			},500);
			$('.search-movie input').val(``);
			if ($('.search-movie input').val() == '') {
				$('.page').css({
					'visibility' : 'hidden'
				})
			}
		},
		error : function(content) {
			$('.search-movie input').val('');
			$('.introduction').fadeIn('1s');
			$('.content-result').html(``);
			$('.page').css({
				'visibility' : 'hidden'
			});
		}
	});
}
$('.navbar-nav li a').on('click',function(){
	function addOn(name) {
		let page = ['search','social','about'];
		page.forEach(function(p){
			if (p != name) {
				$(`.navbar-nav .${p}`).removeClass('active');
			} else {
				$(`.navbar-nav .${name}`).addClass('active');
			}
		});
		return name;
	}
	loadPage(addOn($(this).data('page')));
});